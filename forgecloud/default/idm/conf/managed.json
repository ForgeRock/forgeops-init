{
    "objects" : [
        {
            "name": "teammember",
            "actions": {
                "resetPassword": {
                    "type": "text/javascript",
                    "source": "require('resetPassword').sendMail(object);"
                },
                "unbind": {
                    "type": "text/javascript",
                    "file": "ui/unBindBehavior.js",
                    "apiDescriptor": {
                        "parameters": [{
                            "name": "provider",
                            "type": "string",
                            "required": true
                        }]
                    }
                },
                "bind": {
                    "type": "text/javascript",
                    "file": "ui/bindBehavior.js",
                    "apiDescriptor": {
                        "parameters": [{
                            "name": "provider",
                            "type": "string",
                            "required": true
                        }]
                    }
                }
            },
            "schema": {
                "id": "urn:jsonschema:org:forgerock:openidm:managed:api:Teammember",
                "title": "Teammember",
                "icon": "fa-user",
                "viewable": true,
                "$schema": "http://json-schema.org/draft-03/schema",
                "order": [
                    "_id",
                    "userName",
                    "password",
                    "givenName",
                    "sn",
                    "mail",
                    "cn",
                    "authzRoles"
                ],
                "properties": {
                    "authzRoles" : {
                        "description" : "Authorization Roles",
                        "title" : "Authorization Roles",
                        "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:authzRoles",
                        "viewable" : true,
                        "type" : "array",
                        "userEditable" : false,
                        "returnByDefault" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "items" : {
                            "type" : "relationship",
                            "title" : "Authorization Roles Items",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:authzRoles:items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "authzMembers",
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Authorization Roles Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "repo/internal/role",
                                    "label" : "Internal Role",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "_id",
                                            "description"
                                        ]
                                    }
                                },
                                {
                                    "path" : "managed/role",
                                    "label" : "Role",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "name"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "_id": {
                        "description": "User ID",
                        "type": "string",
                        "viewable": false,
                        "searchable": false,
                        "userEditable": false,
                        "usageDescription": "",
                        "isPersonal": false,
                        "policies": [{
                            "policyId": "cannot-contain-characters",
                            "params": {
                                "forbiddenChars": [
                                    "/"
                                ]
                            }
                        }]
                    },
                    "password": {
                        "title": "Password",
                        "description": "Password",
                        "type": "string",
                        "viewable": false,
                        "searchable": false,
                        "userEditable": true,
                        "scope": "private",
                        "isProtected": true,
                        "usageDescription": "",
                        "isPersonal": false
                    },
                    "mail": {
                        "title": "Email Address",
                        "description": "Email Address",
                        "viewable": true,
                        "type": "string",
                        "searchable": true,
                        "userEditable": true,
                        "usageDescription": "",
                        "isPersonal": true,
                        "policies": [{
                            "policyId": "valid-email-address-format"
                        }]
                    },
                    "sn": {
                        "title": "Last Name",
                        "description": "Last Name",
                        "viewable": true,
                        "type": "string",
                        "searchable": true,
                        "userEditable": true,
                        "usageDescription": "",
                        "isPersonal": true
                    },
                    "givenName": {
                        "title": "First Name",
                        "description": "First Name",
                        "viewable": true,
                        "type": "string",
                        "searchable": true,
                        "userEditable": true,
                        "usageDescription": "",
                        "isPersonal": true
                    },
                    "country": {
                        "type": "string",
                        "title": "Country",
                        "description": "Country",
                        "viewable": true,
                        "userEditable": true,
                        "usageDescription": "",
                        "isPersonal": false
                    },
                    "userName": {
                        "title": "Username",
                        "description": "Username",
                        "viewable": true,
                        "type": "string",
                        "searchable": true,
                        "userEditable": true,
                        "minLength": 1,
                        "usageDescription": "",
                        "isPersonal": true,
                        "policies": [{
                                "policyId": "unique"
                            },
                            {
                                "policyId": "cannot-contain-characters",
                                "params": {
                                    "forbiddenChars": [
                                        "/"
                                    ]
                                }
                            }
                        ]
                    },
                    "cn": {
                        "description": "Common Name",
                        "type": "string",
                        "viewable": false,
                        "searchable": false,
                        "userEditable": false,
                        "scope": "private",
                        "isPersonal": true,
                        "isVirtual": true,
                        "onStore": {
                            "type": "text/javascript",
                            "source": "object.cn || (object.givenName + ' ' + object.sn)"
                        }
                    }
                },
                "type": "object",
                "required": [
                    "userName",
                    "mail",
                    "password"
                ]
            },
            "meta": {
                "property": "_meta",
                "resourceCollection": "internal/usermeta",
                "trackedProperties": [
                    "createDate",
                    "lastChanged"
                ]
            }
        },
        {
            "name" : "user",
            "actions" : {
                "resetPassword" : {
                    "type" : "text/javascript",
                    "source" : "require('resetPassword').sendMail(object);"
                },
                "unbind" : {
                    "type" : "text/javascript",
                    "file" : "ui/unBindBehavior.js",
                    "apiDescriptor" : {
                        "parameters" : [
                            {
                                "name" : "provider",
                                "type" : "string",
                                "required" : true
                            }
                        ]
                    }
                },
                "bind" : {
                    "type" : "text/javascript",
                    "file" : "ui/bindBehavior.js",
                    "apiDescriptor" : {
                        "parameters" : [
                            {
                                "name" : "provider",
                                "type" : "string",
                                "required" : true
                            }
                        ]
                    }
                }
            },
            "schema" : {
                "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User",
                "title" : "User",
                "icon" : "fa-user",
                "viewable" : true,
                "$schema" : "http://json-schema.org/draft-03/schema",
                "order" : [
                    "_id",
                    "userName",
                    "password",
                    "name",
                    "emails",
                    "displayName",
                    "nickName",
                    "profileUrl",
                    "userType",
                    "title",
                    "preferredLanguage",
                    "locale",
                    "timezone",
                    "active",
                    "kbaInfo",
                    "customAttributes",
                    "preferences",
                    "cn",
                    "sn",
                    "mail",
                    "ims",
                    "photos",
                    "x509Certificates",
                    "addresses",
                    "phoneNumbers"
               ],
                "properties" : {
                    "mail": {
                         "title": "Email Address",
                         "description": "Email Address",
                         "viewable": true,
                         "type": "string"
                     },
                    "profileUrl" : {
                        "title" : "profile url",
                        "description" : "profile url",
                        "type" : "string",
                        "viewable" : true,
                        "searchable" : true,
                        "userEditable" : true
                    },
                    "_id" : {
                        "description" : "User ID",
                        "type" : "string",
                        "viewable" : false,
                        "searchable" : false,
                        "userEditable" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "policies" : [
                            {
                                "policyId" : "cannot-contain-characters",
                                "params" : {
                                    "forbiddenChars" : [
                                        "/"
                                    ]
                                }
                            }
                        ]
                    },
                    "password" : {
                        "title" : "Password",
                        "description" : "Password",
                        "type" : "string",
                        "viewable" : false,
                        "searchable" : false,
                        "userEditable" : true,
                        "scope" : "private",
                        "isProtected" : true,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "kbaInfo" : {
                        "description" : "KBA Info",
                        "type" : "array",
                        "userEditable" : true,
                        "viewable" : false,
                        "usageDescription" : "",
                        "isPersonal" : true,
                        "items" : {
                            "type" : "object",
                            "title" : "KBA Info Items",
                            "properties" : {
                                "answer" : {
                                    "description" : "Answer",
                                    "type" : "string"
                                },
                                "customQuestion" : {
                                    "description" : "Custom question",
                                    "type" : "string"
                                },
                                "questionId" : {
                                    "description" : "Question ID",
                                    "type" : "string"
                                }
                            },
                            "order" : [
                                "answer",
                                "customQuestion",
                                "questionId"
                            ],
                            "required" : [ ]
                        }
                    },
                    "customAttributes": {
                        "title" : "Custom Attributes",
                        "description" : "Custom Attributes",
                        "viewable" : true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "object",
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "properties" : {
                        },
                        "order" : [
                        ],
                        "required" : [ ]
                    },
                    "preferences" : {
                        "title" : "Preferences",
                        "description" : "Preferences",
                        "viewable" : true,
                        "searchable" : false,
                        "userEditable" : true,
                        "type" : "object",
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "properties" : {
                        },
                        "order" : [
                        ],
                        "required" : [ ]
                    },
                    "phoneNumbers":{
                        "title": "phone numbers",
                        "description": "phone numbers",
                        "viewable": true,
                        "type" : "array",
                        "searchable" : true,
                        "userEditable" : true,
                        "items": {
                            "type":"object",
                            "title": "phone items",
                            "properties" : {
                                "value" : {
                                    "description" : "value",
                                    "type" : "string"
                                },
                                "type" : {
                                    "description" : "type",
                                    "type" : "string"
                                }
                            },
                            "order" : [
                                "type",
                                "value"
                            ],
                            "required" : [ ]
                        }
                    },
                    "ims":{
                        "title": "ims",
                        "description": "ims",
                        "viewable": true,
                        "type" : "array",
                        "searchable" : true,
                        "userEditable" : true,
                        "items": {
                            "type":"object",
                            "title": "im items",
                            "properties" : {
                                "value" : {
                                    "description" : "value",
                                    "type" : "string"
                                },
                                "type" : {
                                    "description" : "type",
                                    "type" : "string"
                                }
                            },
                            "order" : [
                                "type",
                                "value"
                            ],
                            "required" : [ ]
                        }
                    },
                    "addresses":{
                        "title": "addresses",
                        "description": "addresses",
                        "viewable": true,
                        "type" : "array",
                        "searchable" : true,
                        "userEditable" : true,
                        "items": {
                            "type":"object",
                            "title": "address items",
                            "properties" : {
                                "type" : {
                                    "description" : "type",
                                    "type" : "string"
                                },
                                "streetAddress" : {
                                    "description" : "streetAddress",
                                    "type" : "string"
                                },
                                "locality" : {
                                    "description" : "locality",
                                    "type" : "string"
                                },
                                "region" : {
                                    "description" : "region",
                                    "type" : "string"
                                },
                                "postalCode" : {
                                    "description" : "postalCode",
                                    "type" : "string"
                                },
                                "country" : {
                                    "description" : "country",
                                    "type" : "string"
                                },
                                "formatted" : {
                                    "description" : "formatted",
                                    "type" : "string"
                                },
                                "primary" : {
                                    "description" : "primary",
                                    "type" : "boolean"
                                }
                            },
                            "order" : [
                                "type",
                                "streetAddress",
                                "locality",
                                "region",
                                "postalCode",
                                "country",
                                "formatted",
                                "primary"
                            ],
                            "required" : [ ]
                        }
                    },
                    "x509Certificates":{
                        "title": "509 certs",
                        "description": "509 certs",
                        "viewable": true,
                        "type" : "array",
                        "searchable" : true,
                        "userEditable" : true,
                        "items": {
                            "type":"object",
                            "title": "cert items",
                            "properties" : {
                                "value" : {
                                    "description" : "value",
                                    "type" : "string"
                                }
                            },
                            "order" : [
                                "value"
                            ],
                            "required" : [ ]
                        }
                    },
                    "photos":{
                        "title": "photos",
                        "description": "photos",
                        "viewable": true,
                        "type" : "array",
                        "searchable" : true,
                        "userEditable" : true,
                        "items": {
                            "type":"object",
                            "title": "photo items",
                            "properties" : {
                                "value" : {
                                    "description" : "value",
                                    "type" : "string"
                                },
                                "type" : {
                                    "description" : "type",
                                    "type" : "string"
                                }
                            },
                            "order" : [
                                "type",
                                "value"
                            ],
                            "required" : [ ]
                        }
                    },
                    "emails" : {
                        "title": "Emails",
                        "description": "Emails",
                        "viewable": true,
                        "type" : "array",
                        "searchable" : true,
                        "userEditable" : true,
                        "items": {
                            "type":"object",
                            "title": "email items",
                            "properties" : {
                                "value" : {
                                    "description" : "value",
                                    "type" : "string",
                                    "policies": [{
                                        "policyId": "valid-email-address-format"
                                    }]
                                },
                                "type" : {
                                    "description" : "type",
                                    "type" : "string"
                                },
                                "primary": {
                                    "description": "primary",
                                    "type": "boolean"
                                }
                            },
                            "order" : [
                                "type",
                                "value",
                                "primary"
                            ],
                            "required" : [ ]
                        }
                    },
                    "name": {
                        "description" : "Name",
                        "type" : "object",
                        "properties" : {
                            "formatted": "string",
                            "familyName": "string",
                            "givenName": "string",
                            "middleName": "string",
                            "honorificPrefix": "string",
                            "honorificSuffix": "string"
                        }
                      },
                    "cn" : {
                        "description" : "Common Name",
                        "type" : "string",
                        "viewable" : false,
                        "searchable" : false,
                        "userEditable" : false,
                        "scope" : "private",
                        "isPersonal" : true,
                        "isVirtual" : true,
                        "onStore" : {
                            "type" : "text/javascript",
                            "source" : "object.cn || (object.givenName + ' ' + object.sn)"
                        }
                    },
                    "displayName": {
                        "description": "display name",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    "nickName" : {
                        "description" : "nickname",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    "userType": {
                        "description" : "user type",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    "title": {
                        "description" : "title ",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    "preferredLanguage": {
                        "description" : "preferred language",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    "locale": {
                        "description" : "locale",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    "timezone": {
                        "description" : "timezone",
                        "viewable": true,
                        "searchable" : true,
                        "userEditable" : true,
                        "type" : "string"
                    },
                    
                    "organizationName" : {
                        "title" : "Organization Name",
                        "description" : "Organization Name",
                        "viewable" : true,
                        "type" : "string",
                        "searchable" : true,
                        "userEditable" : false,
                        "usageDescription" : "",
                        "isPersonal" : true
                    },
                    "sn" : {
                        "title" : "Last Name",
                        "description" : "Last Name",
                        "viewable" : true,
                        "type" : "string",
                        "searchable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : true
                    },
                    "description" : {
                        "title" : "Description",
                        "description" : "Description",
                        "viewable" : true,
                        "type" : "string",
                        "searchable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "address2" : {
                        "type" : "string",
                        "title" : "Address 2",
                        "description" : "Address 2",
                        "viewable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : true
                    },
                    "givenName" : {
                        "title" : "First Name",
                        "description" : "First Name",
                        "viewable" : true,
                        "type" : "string",
                        "searchable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : true
                    },
                    "city" : {
                        "type" : "string",
                        "title" : "City",
                        "description" : "City",
                        "viewable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "country" : {
                        "type" : "string",
                        "title" : "Country",
                        "description" : "Country",
                        "viewable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "postalCode" : {
                        "type" : "string",
                        "title" : "Postal Code",
                        "description" : "Postal Code",
                        "viewable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "active" : {
                        "title" : "Status",
                        "description" : "Status",
                        "viewable" : true,
                        "type" : "string",
                        "searchable" : true,
                        "userEditable" : false,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "roles" : {
                        "description" : "Provisioning Roles",
                        "title" : "Provisioning Roles",
                        "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:roles",
                        "viewable" : true,
                        "userEditable" : false,
                        "returnByDefault" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "type" : "array",
                        "relationshipGrantTemporalConstraintsEnforced" : true,
                        "items" : {
                            "type" : "relationship",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:roles:items",
                            "title" : "Provisioning Roles Items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "members",
                            "validate" : true,
                            "notifySelf" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Provisioning Roles Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        },
                                        "_grantType" : {
                                            "description" : "Grant Type",
                                            "type" : "string",
                                            "label" : "Grant Type"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "managed/role",
                                    "label" : "Role",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "name"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "authzRoles" : {
                        "description" : "Authorization Roles",
                        "title" : "Authorization Roles",
                        "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:authzRoles",
                        "viewable" : true,
                        "type" : "array",
                        "userEditable" : false,
                        "returnByDefault" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "items" : {
                            "type" : "relationship",
                            "title" : "Authorization Roles Items",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:authzRoles:items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "authzMembers",
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Authorization Roles Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "repo/internal/role",
                                    "label" : "Internal Role",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "_id",
                                            "description"
                                        ]
                                    }
                                },
                                {
                                    "path" : "managed/role",
                                    "label" : "Role",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "name"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "reports" : {
                        "description" : "Direct Reports",
                        "title" : "Direct Reports",
                        "viewable" : true,
                        "userEditable" : false,
                        "type" : "array",
                        "returnByDefault" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "items" : {
                            "type" : "relationship",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:User:reports:items",
                            "title" : "Direct Reports Items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "manager",
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Direct Reports Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "managed/user",
                                    "label" : "User",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "userName",
                                            "givenName",
                                            "sn"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "effectiveRoles" : {
                        "type" : "array",
                        "title" : "Effective Roles",
                        "description" : "Effective Roles",
                        "viewable" : false,
                        "returnByDefault" : true,
                        "isVirtual" : true,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "onRetrieve" : {
                            "type" : "text/javascript",
                            "source" : "require('roles/effectiveRoles').calculateEffectiveRoles(object, 'roles');"
                        },
                        "items" : {
                            "type" : "object",
                            "title" : "Effective Roles Items"
                        }
                    },
                    "effectiveAssignments" : {
                        "type" : "array",
                        "title" : "Effective Assignments",
                        "description" : "Effective Assignments",
                        "viewable" : false,
                        "returnByDefault" : true,
                        "isVirtual" : true,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "onRetrieve" : {
                            "type" : "text/javascript",
                            "file" : "roles/effectiveAssignments.js",
                            "effectiveRolesPropName" : "effectiveRoles"
                        },
                        "items" : {
                            "type" : "object",
                            "title" : "Effective Assignments Items"
                        }
                    },
                    "telephoneNumber" : {
                        "type" : "string",
                        "title" : "Mobile Phone",
                        "description" : "Mobile Phone",
                        "viewable" : true,
                        "userEditable" : true,
                        "pattern" : "^\\+?([0-9\\- \\(\\)])*$",
                        "usageDescription" : "",
                        "isPersonal" : true
                    },
                    "stateProvince" : {
                        "type" : "string",
                        "title" : "State/Province",
                        "description" : "State/Province",
                        "viewable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : false
                    },
                    "postalAddress" : {
                        "type" : "string",
                        "title" : "Address 1",
                        "description" : "Address 1",
                        "viewable" : true,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : true
                    },
                    "userName" : {
                        "title" : "Username",
                        "description" : "Username",
                        "viewable" : true,
                        "type" : "string",
                        "searchable" : true,
                        "userEditable" : true,
                        "minLength" : 1,
                        "usageDescription" : "",
                        "isPersonal" : true,
                        "policies" : [
                            {
                                "policyId" : "unique"
                            },
                            {
                                "policyId" : "cannot-contain-characters",
                                "params" : {
                                    "forbiddenChars" : [
                                        "/"
                                    ]
                                }
                            }
                        ]
                    },
                    "manager" : {
                        "type" : "relationship",
                        "validate" : true,
                        "reverseRelationship" : true,
                        "reversePropertyName" : "reports",
                        "description" : "Manager",
                        "title" : "Manager",
                        "viewable" : true,
                        "searchable" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "properties" : {
                            "_ref" : {
                                "description" : "References a relationship from a managed object",
                                "type" : "string"
                            },
                            "_refProperties" : {
                                "description" : "Supports metadata within the relationship",
                                "type" : "object",
                                "title" : "Manager _refProperties",
                                "properties" : {
                                    "_id" : {
                                        "description" : "_refProperties object ID",
                                        "type" : "string"
                                    }
                                }
                            }
                        },
                        "resourceCollection" : [
                            {
                                "path" : "managed/user",
                                "label" : "User",
                                "query" : {
                                    "queryFilter" : "true",
                                    "fields" : [
                                        "userName",
                                        "givenName",
                                        "sn"
                                    ]
                                }
                            }
                        ],
                        "userEditable" : false
                    },
                    "lastSync" : {
                        "description" : "Last Sync timestamp",
                        "title" : "Last Sync timestamp",
                        "type" : "object",
                        "scope" : "private",
                        "viewable" : false,
                        "searchable" : false,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "properties" : {
                            "effectiveAssignments" : {
                                "description" : "Effective Assignments",
                                "title" : "Effective Assignments",
                                "type" : "array",
                                "items" : {
                                    "type" : "object",
                                    "title" : "Effective Assignments Items"
                                }
                            },
                            "timestamp" : {
                                "description" : "Timestamp",
                                "type" : "string"
                            }
                        },
                        "order" : [
                            "effectiveAssignments",
                            "timestamp"
                        ],
                        "required" : [ ]
                    },
                    "consentedMappings" : {
                        "title" : "Consented Mappings",
                        "description" : "Consented Mappings",
                        "type" : "array",
                        "viewable" : false,
                        "searchable" : false,
                        "userEditable" : true,
                        "usageDescription" : "",
                        "isPersonal" : false,
                        "items" : {
                            "type" : "array",
                            "title" : "Consented Mappings Items",
                            "items" : {
                                "type" : "object",
                                "title" : "Consented Mappings Item",
                                "properties" : {
                                    "mapping" : {
                                        "title" : "Mapping",
                                        "description" : "Mapping",
                                        "type" : "string",
                                        "viewable" : true,
                                        "searchable" : true,
                                        "userEditable" : true
                                    },
                                    "consentDate" : {
                                        "title" : "Consent Date",
                                        "description" : "Consent Date",
                                        "type" : "string",
                                        "viewable" : true,
                                        "searchable" : true,
                                        "userEditable" : true
                                    }
                                },
                                "order" : [
                                    "mapping",
                                    "consentDate"
                                ],
                                "required" : [
                                    "mapping",
                                    "consentDate"
                                ]
                            }
                        },
                        "returnByDefault" : false,
                        "isVirtual" : false
                    },
                    "aliasList" : {
                        "description" : "Alias List",
                        "type" : "array",
                        "items" : {
                            "type" : "string"
                        },
                        "viewable" : false,
                        "searchable" : false,
                        "userEditable" : false,
                        "scope" : "private",
                        "isPersonal" : false
                    },
                    
                    "idps" : {
                        "title" : "Identity Providers",
                        "viewable" : true,
                        "searchable" : false,
                        "userEditable" : false,
                        "returnByDefault" : false,
                        "type" : "array",
                        "items" : {
                            "type" : "relationship",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "user",
                            "notifySelf" : true,
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Identity Providers _refProperties",
                                    "properties" : { }
                                }
                            },
                            "resourceCollection" : []
                        }
                    }
                },
                "type" : "object",
                "required" : [
                    "userName",
                    "mail",
                    "sn"
                ]
            },
            "meta" : {
                "property" : "_meta",
                "resourceCollection" : "internal/usermeta",
                "trackedProperties" : [
                    "createDate",
                    "lastChanged"
                ]
            }
        },
        {

            "name" : "role",
            "onDelete" : {
                "type" : "text/javascript",
                "file" : "roles/onDelete-roles.js"
            },
            "onCreate" : {
                "type" : "text/javascript",
                "source" : "require('roles/conditionalRoles').roleCreate(object);"
            },
            "onUpdate" : {
                "type" : "text/javascript",
                "source" : "require('roles/conditionalRoles').roleUpdate(oldObject, object);"
            },
            "postCreate" : {
                "type" : "text/javascript",
                "source" : "require('roles/postOperation-roles').manageTemporalConstraints(resourceName);"
            },
            "postUpdate" : {
                "type" : "text/javascript",
                "source" : "require('roles/postOperation-roles').manageTemporalConstraints(resourceName);"
            },
            "postDelete" : {
                "type" : "text/javascript",
                "source" : "require('roles/postOperation-roles').manageTemporalConstraints(resourceName);"
            },
            "schema" : {
                "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:Role",
                "$schema" : "http://forgerock.org/json-schema#",
                "type" : "object",
                "title" : "Role",
                "icon" : "fa-check-square-o",
                "description" : "",
                "properties" : {
                    "_id" : {
                        "description" : "Role ID",
                        "title" : "Name",
                        "viewable" : false,
                        "searchable" : false,
                        "type" : "string"
                    },
                    "name" : {
                        "description" : "The role name, used for display purposes.",
                        "title" : "Name",
                        "viewable" : true,
                        "searchable" : true,
                        "type" : "string"
                    },
                    "description" : {
                        "description" : "The role description, used for display purposes.",
                        "title" : "Description",
                        "viewable" : true,
                        "searchable" : true,
                        "type" : "string"
                    },
                    "members" : {
                        "description" : "Role Members",
                        "title" : "Role Members",
                        "viewable" : true,
                        "type" : "array",
                        "returnByDefault" : false,
                        "relationshipGrantTemporalConstraintsEnforced" : true,
                        "items" : {
                            "type" : "relationship",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:Role:members:items",
                            "title" : "Role Members Items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "roles",
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Role Members Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        },
                                        "_grantType" : {
                                            "description" : "Grant Type",
                                            "type" : "string",
                                            "label" : "Grant Type"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "managed/user",
                                    "notify" : true,
                                    "label" : "User",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "userName",
                                            "givenName",
                                            "sn"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "authzMembers" : {
                        "description" : "Authorization Role Members",
                        "title" : "Authorization Role Members",
                        "viewable" : true,
                        "type" : "array",
                        "returnByDefault" : false,
                        "items" : {
                            "type" : "relationship",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:Role:authzMembers:items",
                            "title" : "Authorization Role Members Items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "authzRoles",
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Authorization Role Members Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "managed/user",
                                    "label" : "User",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "userName",
                                            "givenName",
                                            "sn"
                                        ]
                                    }
                                }
                            ]
                        }
                    },
                    "assignments" : {
                        "description" : "Managed Assignments",
                        "title" : "Managed Assignments",
                        "viewable" : true,
                        "returnByDefault" : false,
                        "type" : "array",
                        "items" : {
                            "type" : "relationship",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:Role:assignments:items",
                            "title" : "Managed Assignments Items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "roles",
                            "notifySelf" : true,
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "title" : "Managed Assignments Items _refProperties",
                                    "type" : "object",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "managed/assignment",
                                    "label" : "Assignment",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "name"
                                        ]
                                    }
                                }
                            ]
                        },
                        "notifyRelationships" : ["members"]
                    },
                    "condition" : {
                        "description" : "A conditional filter for this role",
                        "title" : "Condition",
                        "viewable" : false,
                        "searchable" : false,
                        "type" : "string"
                    },
                    "temporalConstraints" : {
                        "description" : "An array of temporal constraints for a role",
                        "title" : "Temporal Constraints",
                        "viewable" : false,
                        "returnByDefault" : true,
                        "type" : "array",
                        "items" : {
                            "type" : "object",
                            "title" : "Temporal Constraints Items",
                            "properties" : {
                                "duration" : {
                                    "description" : "Duration",
                                    "type" : "string"
                                }
                            },
                            "required" : [
                                "duration"
                            ],
                            "order" : [
                                "duration"
                            ]
                        },
                        "notifyRelationships" : ["members"]
                    }
                },
                "required" : [
                    "name"
                ],
                "order" : [
                    "_id",
                    "name",
                    "description",
                    "members",
                    "authzMembers",
                    "assignments",
                    "condition",
                    "temporalConstraints"
                ]
            }
        },
        {
            "name" : "assignment",
            "schema" : {
                "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:Assignment",
                "$schema" : "http://forgerock.org/json-schema#",
                "type" : "object",
                "title" : "Assignment",
                "icon" : "fa-key",
                "description" : "A role assignment",
                "properties" : {
                    "_id" : {
                        "description" : "The assignment ID",
                        "title" : "Name",
                        "viewable" : false,
                        "searchable" : false,
                        "type" : "string"
                    },
                    "name" : {
                        "description" : "The assignment name, used for display purposes.",
                        "title" : "Name",
                        "viewable" : true,
                        "searchable" : true,
                        "type" : "string"
                    },
                    "description" : {
                        "description" : "The assignment description, used for display purposes.",
                        "title" : "Description",
                        "viewable" : true,
                        "searchable" : true,
                        "type" : "string"
                    },
                    "mapping" : {
                        "description" : "The name of the mapping this assignment applies to",
                        "title" : "Mapping",
                        "viewable" : true,
                        "searchable" : true,
                        "type" : "string",
                        "policies" : [
                            {
                                "policyId" : "mapping-exists"
                            }
                        ]
                    },
                    "attributes" : {
                        "description" : "The attributes operated on by this assignment.",
                        "title" : "Assignment Attributes",
                        "viewable" : true,
                        "type" : "array",
                        "items" : {
                            "type" : "object",
                            "title" : "Assignment Attributes Items",
                            "properties" : {
                                "assignmentOperation" : {
                                    "description" : "Assignment operation",
                                    "type" : "string"
                                },
                                "unassignmentOperation" : {
                                    "description" : "Unassignment operation",
                                    "type" : "string"
                                },
                                "name" : {
                                    "description" : "Name",
                                    "type" : "string"
                                },
                                "value" : {
                                    "description" : "Value",
                                    "type" : "string"
                                }
                            },
                            "order" : [
                                "assignmentOperation",
                                "unassignmentOperation",
                                "name",
                                "value"
                            ],
                            "required" : [ ]
                        },
                        "notifyRelationships" : ["roles"]
                    },
                    "linkQualifiers" : {
                        "description" : "Conditional link qualifiers to restrict this assignment to.",
                        "title" : "Link Qualifiers",
                        "viewable" : true,
                        "type" : "array",
                        "items" : {
                            "type" : "string",
                            "title" : "Link Qualifiers Items"
                        }
                    },
                    "roles" : {
                        "description" : "Managed Roles",
                        "title" : "Managed Roles",
                        "viewable" : true,
                        "userEditable" : false,
                        "type" : "array",
                        "returnByDefault" : false,
                        "items" : {
                            "type" : "relationship",
                            "id" : "urn:jsonschema:org:forgerock:openidm:managed:api:Assignment:roles:items",
                            "title" : "Managed Roles Items",
                            "reverseRelationship" : true,
                            "reversePropertyName" : "assignments",
                            "validate" : true,
                            "properties" : {
                                "_ref" : {
                                    "description" : "References a relationship from a managed object",
                                    "type" : "string"
                                },
                                "_refProperties" : {
                                    "description" : "Supports metadata within the relationship",
                                    "type" : "object",
                                    "title" : "Managed Roles Items _refProperties",
                                    "properties" : {
                                        "_id" : {
                                            "description" : "_refProperties object ID",
                                            "type" : "string"
                                        }
                                    }
                                }
                            },
                            "resourceCollection" : [
                                {
                                    "path" : "managed/role",
                                    "notify" : true,
                                    "label" : "Role",
                                    "query" : {
                                        "queryFilter" : "true",
                                        "fields" : [
                                            "name"
                                        ]
                                    }
                                }
                            ]
                        }
                    }
                },
                "required" : [
                    "name",
                    "description",
                    "mapping"
                ],
                "order" : [
                    "_id",
                    "name",
                    "description",
                    "mapping",
                    "attributes",
                    "linkQualifiers",
                    "roles"
                ]
            }
        }
    ]
}
